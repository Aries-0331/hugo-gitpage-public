<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Aries notebook</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Aries" /><meta name="description" content="Aries notebook" /><meta name="keywords" content="Aries, blog, hugo" />






<meta name="generator" content="Hugo 0.123.2 with theme even" />


<link rel="canonical" href="https://urchinzhou.com/" />
  <link href="https://urchinzhou.com/index.xml" rel="alternate" type="application/rss+xml" title="Aries notebook" />
  <link href="https://urchinzhou.com/index.xml" rel="feed" type="application/rss+xml" title="Aries notebook" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">



<meta property="og:title" content="Aries notebook" />
<meta property="og:description" content="Aries notebook" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://urchinzhou.com/" />

<meta itemprop="name" content="Aries notebook">
<meta itemprop="description" content="Aries notebook"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Aries notebook"/>
<meta name="twitter:description" content="Aries notebook"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXXX-X"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-XXXXXXXXX-X');
</script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Aries</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Aries</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <section id="posts" class="posts">
    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/ipc-%E7%AE%A1%E9%81%93/">IPC 管道</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2024-02-23 </span>
      <div class="post-category">
          <a href="/categories/linux/"> linux </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      管道（Pipe）是一种在类 Unix 系统中，用于进程间通信的机制。它允许一个进程的输出直接成为另一个进程的输入，常见于命令行环境，它能够将一个命令的
    </div>
    <div class="read-more">
      <a href="/post/ipc-%E7%AE%A1%E9%81%93/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/javascript-basic-summarize/">JavaScript Basic Summarize</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2024-01-30 </span>
      <div class="post-category">
          <a href="/categories/javascript/"> javascript </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      Typically something that are easy to forget or misunderstand.
Data types JavaScript is a dynamic language with dynamic types. Variables in JavaScript are not directly associated with any particular value type, and any variable can be assigned (and re-assigned) values of all types.
JavaScript is also a weakly typed language, which means it allows implicit type conversion when an operation involves mismatched types, instead of throwing type errors.
Implicit coercions are very convenient, but can create subtle bugs when conversions happen where they are not expected, or where they are expected to happen in the other direction (for example, string to number instead of number to string).
    </div>
    <div class="read-more">
      <a href="/post/javascript-basic-summarize/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/tcp/">What happens when tcp listen to a port?</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2023-06-29 </span>
      <div class="post-category">
          <a href="/categories/tcp/"> tcp </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      When reading the net/http code of golang, I was suddenly curious about the mechanism of tcp listen, then I googled and found this interesting Q&amp;A - What happens when we say &ldquo;listen to a port&rdquo;? on StackOverflow.
Q:When we start a server application, we always need to speicify the port number it listens to. But how is this &ldquo;listening mechanism&rdquo; implemented under the hood?
My current imagination is like this:
    </div>
    <div class="read-more">
      <a href="/post/tcp/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/go-basic---interface-as-parameter-to-function/">Go Basic - Interface as Parameter to Function</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2023-06-29 </span>
      <div class="post-category">
          <a href="/categories/go/"> go </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      https://stackoverflow.com/questions/20314604/go-syntax-and-interface-as-parameter-to-function
Go uses interfaces for generalization of types. So if you want a function that takes a specific interface you write
1 func MyFunction(t SomeInterface) {...} Every type that satisfies SomeInterface can be passed to MyFunction.
Now, SomeInterface can look like this:
1 2 3 type SomeInterface interface { SomeFunction() } To satisfy SomeInterface, the type implementing it must implement SomeFunction().
If you, however, require an empty interface (interface{}) the object does not need to implement any method to be passed to the function:
    </div>
    <div class="read-more">
      <a href="/post/go-basic---interface-as-parameter-to-function/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/go-package---gorm/">Go Package - gorm</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2023-06-28 </span>
      <div class="post-category">
          <a href="/categories/go/"> go </a>
          <a href="/categories/aigc/"> aigc </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      GORM is a popular Object-Relational Mapping (ORM) package for Go, designed to simplify database operations and improve developer productivity. It provides a robust and expressive API for interacting with various databases, including PostgreSQL, MySQL, SQLite, and more. With GORM, you can focus on your application&rsquo;s logic while it handles the complexities of database management.
Main Usage of GORM:
Model Definition: GORM allows you to define models, which are Go structs representing database tables.
    </div>
    <div class="read-more">
      <a href="/post/go-package---gorm/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/go-package---gorilla-mux/">Go Package - gorilla mux</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2023-06-27 </span>
      <div class="post-category">
          <a href="/categories/go/"> go </a>
          <a href="/categories/aigc/"> aigc </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      Gorilla/mux is a popular package in the Go ecosystem that simplifies routing and URL matching for HTTP services. It offers a rich set of features and allows developers to define custom routes, handle variables, and leverage middleware for enhanced functionality. With gorilla/mux, you can build scalable and maintainable web applications with ease.
Main Usage of gorilla/mux:
Routing: Gorilla/mux enables you to define powerful and dynamic routes by leveraging patterns, placeholders, and regular expressions.
    </div>
    <div class="read-more">
      <a href="/post/go-package---gorilla-mux/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/vs-code-%E5%AE%89%E8%A3%85-go-%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7%E5%A4%B1%E8%B4%A5/">VSCode 安装 Go 相关工具失败</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2023-06-26 </span>
      <div class="post-category">
          <a href="/categories/vscode/"> vscode </a>
          <a href="/categories/go/"> go </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      1 go version go1.19.5 windows/amd64 使用 VS Code 安装 Go 插件后，安装关联工具时，输出内容报如下内容，或错误信息中包含类似 unresponse、timeout 等网络问题相关字
    </div>
    <div class="read-more">
      <a href="/post/vs-code-%E5%AE%89%E8%A3%85-go-%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7%E5%A4%B1%E8%B4%A5/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/a-glance-at-javascript/">About JavaScript</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2023-06-24 </span>
      <div class="post-category">
          <a href="/categories/javascript/"> javascript </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      Introduction: Welcome, esteemed senior engineers, to the realm of JavaScript! As experts in object-oriented languages like C++, you are well-positioned to explore the unique features and possibilities that JavaScript offers. In this blog, we will delve into JavaScript&rsquo;s language features, grammar, application scenarios, and provide insights on becoming a professional JavaScript developer.
JavaScript Language Features: Discover the dynamic nature of JavaScript and its powerful capabilities. Learn about JavaScript&rsquo;s prototypal inheritance model, functional programming concepts, lexical scoping, closures, and the event-driven nature of the language.
    </div>
    <div class="read-more">
      <a href="/post/a-glance-at-javascript/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/mastering-chatgptcrafting-effective-prompt/">Mastering ChatGPT：Crafting Effective Prompt</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2023-06-23 </span>
      <div class="post-category">
          <a href="/categories/aigc/"> AIGC </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      Introduction: Engaging in conversations with AI models like ChatGPT can be an exciting and rewarding experience. However, achieving meaningful and accurate responses relies heavily on the quality of prompts provided. In this blog post, we will explore strategies for crafting excellent prompts that maximize the potential of ChatGPT and enhance the overall conversation. Let&rsquo;s dive in and unlock the power of effective prompts!
Be Clear and Specific: Clearly communicate your intention and provide specific context in your prompts.
    </div>
    <div class="read-more">
      <a href="/post/mastering-chatgptcrafting-effective-prompt/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/html-introduction/">HTML Introduction</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2023-06-21 </span>
      <div class="post-category">
          <a href="/categories/web/"> Web </a>
          <a href="/categories/aigc/"> AIGC </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      This blog is an attempt to generate with ai.
In this blog post, we will embark on a journey into the world of web technology and explore the fundamental aspects of HTML (Hypertext Markup Language). As a crucial language for structuring web content, HTML lays the groundwork for creating visually appealing and interactive websites. Let&rsquo;s dive in!
HTML Essentials: HTML employs tags to define elements and organize information on web pages.
    </div>
    <div class="read-more">
      <a href="/post/html-introduction/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAgit%E4%BB%93%E5%BA%93%E7%9A%84ssh%E6%9D%83%E9%99%90/">在新环境中配置多 Git 仓库的 ssh 权限</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2022-11-11 </span>
      <div class="post-category">
          <a href="/categories/git/"> Git </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      配置多个 Git 仓库的 ssh 权限 跳转至 ssh 配置路径，通常默认为 ~/.ssh 创建 ssh 密钥对，按照提示创建文件名（eg:repo1-deploy-key、repo2-d
    </div>
    <div class="read-more">
      <a href="/post/%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAgit%E4%BB%93%E5%BA%93%E7%9A%84ssh%E6%9D%83%E9%99%90/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/%E5%85%B3%E4%BA%8Equic-crypto/">关于QUIC Crypto</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2022-11-04 </span>
      <div class="post-category">
          <a href="/categories/crypto/"> crypto </a>
          <a href="/categories/quic/"> quic </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <h1 id="简要介绍">简要介绍</h1>
<p>QUIC（Quick UDP Internet Connections）是一种默认加密的互联网传输协议，旨在提供安全、快速的 HTTP 传输，以替代 TCP 和 TLS。Google QUIC 的默认加密协议是自家的 QUIC Crypto。</p>
<p>QUIC 与 TCP 的根本不同在于默认提供安全传输的设计原则。最初的 QUIC 结合了 TCP 的三次握手以及 TLS 1.3 的握手，并将 TLS的记录层数据帧格式替换为 QUIC 自己的，同时保留了 TLS 的握手消息。这种做法既保证了连接总是经过认证和加密的，同时使得初始连接建立速度更快。TCP 和 TLS1.3 完成握手需要两轮交互，而 QUIC 握手仅需一轮，如果客户端缓存了服务端的配置信息，那么甚至无需握手。</p>
<div align=center>
<img src="https://github.com/Aries-0331/pic/blob/master/http-request-over-tcp-tls@2x.png?raw=true" width="600">
<img src="https://github.com/Aries-0331/pic/blob/master/http-request-over-quic@2x.png?raw=true" width="600">
</div>
<h1 id="协商成本对比">协商成本对比</h1>
<h2 id="quic">QUIC</h2>
<p>QUIC 的服务端有一个使用私钥签名的<code>server config</code>参数列表，包含常规参数、 DH 公钥、有效期等信息，由于这些数据都是静态的，所以一次签名后可以长期使用，不需要每次建立连接时都签名。</p>
<p>通道密钥协商使用<code>Diffie-Hellman</code>，DH 算法所需要的服务端参数在<code>server config</code>中，客户端参数通过第一个握手消息传递至服务端。为了实现 0-RTT 握手而设计的静态 <code>server config</code>，同时也带来了加密连接的前向安全问题 —— 只要服务端还保存有 <code>server config</code>，那么一旦密钥泄露，之前使用该密钥加密的数据都是可破解的。</p>
<p>因此 QUIC 提供了两级加密：来自客户端的初始数据使用<code>server config</code>中的 DH 值加密，该值可持久化存储几天，服务端收到客户端的连接后，立即回复一个临时的 DH 值，并重新加密连接。</p>
<p>虽然乍一看这种做法没有 TLS1.3 所实现的前向安全更完善，但实际上， TLS 在大规模部署时为了减少网络交互，通常会启用 <code>SessionTickets</code>，而<code>SessionTickets</code>同样会持久化存储，并被用于破解加密连接，<code>server config</code>和<code>SessionTickets</code>可以说是半斤八两，相较而言 QUIC 提供了临时密钥用于实际通信，反而稍强于 TLS 的做法。</p>
<p>每个连接使用一个临时密钥，与所有连接共用一个临时密钥，在安全性上的差异可以忽略不计，而牺牲这点安全性差异所带来的复杂度打折是很可观的，所以不妨在较短的时间跨度内，将服务器的 DH 密钥复用至所有连接上。</p>
<h2 id="tls13">TLS1.3</h2>
<p>TLS1.3 的握手主要做三件事情：密钥交换、获取服务器参数、认证；</p>
<ul>
<li>
<p>密钥交换：该阶段共享生成密钥所需的材料，例如所属计算方式或命名组（ECDHE or DHE），选择密码参数，例如对称加密选项；</p>
</li>
<li>
<p>服务器参数：该阶段确认其它握手参数，例如是否需要基于数字证书的客户端认证；</p>
</li>
<li>
<p>认证：该阶段对服务端进行认证，对客户端选择性认证，并对密钥进行校验以及握手信息的完整性校验；</p>
</li>
</ul>
<p>TLS 的握手分两种：非前向安全握手和前向安全握手，其与 QUIC 的握手效率对比大概为：</p>
<ul>
<li>
<p>对于非前向安全握手，客户端做一次公钥加密约34us，服务端做一次私钥解密约1100us；</p>
</li>
<li>
<p>对于前向安全握手，客户端做一次公钥加密、一次DH运算、一次伪随机数运算，大约耗时230us，服务端做一次私钥解密、一次DH运算、一次伪随机数运算，大约耗时1300us；</p>
</li>
<li>
<p>QUIC 客户端做一次 DH 运算、两次随机数运算、一次公钥加密，约耗时 184us，服务端做两次随机数运算，约耗时100us；</p>
</li>
</ul>
<p>可以看出 QUIC 与 TLS 在协商阶段的成本差异主要是非对称加解密造成的，当然这里没有包含校验证书链等操作，因为两个协议都有，并且默认两种协议所选的密码算法与选项相同或处于统一性能等级，比如摘要都用SHA-256、DH 曲线都用 Curve25519，如果给 QUIC 选 ECDH P-256 而 TLS 选 Curve25519，那就是另一种结果了。</p>
<p>另外，TLS 有会话恢复机制，而 QUIC 则需要由 C/S 两端各自维护 DH 结果的缓存，虽然没有在协议层面支持这一特性，但牺牲这一便利而带来了大约5倍的效率提升，还是不错的。</p>
<h1 id="quic-handshake">QUIC handshake</h1>
<p>QUIC 的协商过程可以简单总结出三个要点：</p>
<ul>
<li><code>server config</code>是一个包含服务端临时密钥的参数集，大概每几天更新一次；</li>
<li>初次建立连接时的 client hello 其实就是个空的消息，目的就是从 server 获取包含最新 <code>server config</code> 的REJ(ect)消息，获取到后会重新发起正式的 client hello；</li>
<li>server hello 是包含临时密钥的加密消息；</li>
</ul>
<div align=center>
  <img src="https://lh4.googleusercontent.com/DLKsceJfawl4pkbWeaTx69tgW97gG4TQ3BNWBPF3YgtqbkKhHmzgSyL7iajoAibBW9qRx7DcJiCwF2dGZngMFRI3pylhbttoRKZ6LLvQEJuvRepn8gOeya9FrfYd_PvVGRswL6uQCexAimZZdBuUwI5ttPH_mo-i2bVKQFxu9jMosswjo2e4FQvn0YHq" width=500>
</div>
<ul>
<li>首次连接</li>
</ul>
<p>为了实现 0-RTT handshake，客户端需要获取<code>server config</code>，因此首次连接的成本是 1-RTT。</p>
<p>当客户端第一次建立连接时，在握手成功前，客户端会先发送一个不完整的 <code>hello message</code>以获取服务期配置及其真实性证明，而服务端为了避免向任意未证实的端发送大量真实性证明，因此需要验证客户端身份，这一过程可能会有多次交互，不过这些是一次性的。</p>
<p>客户端的<code>hello message</code>中包含一些键值对，例如服务端域名、源地址token、可接受的认证类型、通用证书集合、缓存的证书等（部分是可选的），主要用来表明身份，在收到客户端的<code>hello message</code>后，服务端将返回拒绝消息或<code>server hello</code>。hello 表示握手成功，拒绝消息则会附带供客户端握手使用的一些信息。</p>
<p>例如，若客户端没有携带源地址token，而服务端不想给未认证的IP源发送<code>server config</code>，那么服务端会在拒绝消息中携带源地址token，以便客户端的下次握手校验能通过。</p>
<p><code>server config</code>通过键值对描述服务端的一系列参数，包含 server config ID、密钥交换算法、认证加密算法、公钥列表、有效期、版本等。客户端收到<code>server config</code>后，通过证书链和签名来进行认证，然后就可以发送不会失败的完整握手消息。完整的握手消息除了上述不完整的消息内容外，还包含客户端使用的 server config ID、认证加密算法、密钥家换算法、客户端随机数、服务端随机数、公钥等。</p>
<p>发送完整的<code>hello message</code>后，双方就共同拥有了一个非前向安全密钥（也可称为初始密钥），此时客户端就可以给服务端开始发送应用数据了。</p>
<ul>
<li>非首次连接</li>
</ul>
<p>客户端在首次连接后，会把<code>server config</code>存下来，之后再发起连接时，可直接发送业务数据，以此来实现 0-RTT。</p>
<h1 id="tls13状态机">TLS1.3状态机</h1>
<div align=center><img src="https://cryptologie.net/upload/sm1.png" width=800></div>
<p>从握手的状态图可以很快做出判断，TLS 比 QUIC 复杂好多。TLS 是一个相对可靠、完善的协议，但同时由于版本迭代较多，大量历史遗留问题导致其架构、接口、用例非常复杂，如果不考虑历史包袱等兼容性问题，应该可以设计出更优雅的“TLS”。</p>
<h1 id="密钥派生">密钥派生</h1>
<p>QUIC 的密钥材料通过 HMAC-SHA256 密钥派生函数（HKDF）生成，HKDF 采用先提取再扩展的设计方式，先将输入的字符转换为固定长度的伪随机数，然后将其扩展成若干个伪随机密钥。在 QUIC 的实现中，密钥协商阶段生成的 DH 密钥便是 HKDF 的输入。</p>
<ul>
<li>HKDF-Extract</li>
</ul>
<p>使用原始的密钥材料，派生出一个符合密码学强度的伪随机密钥。HKDF-Extract 的输入包含客户端、服务端的nonce以及密钥协商输出的密钥（pre-master key），HKDF-Extract 的输出是一个伪随机密钥，作为主密钥，长度 32 bytes（前提是使用 SHA-256 作为摘要算法）。</p>
<ul>
<li>HKDF-Expand</li>
</ul>
<p>使用 HKDF-Expand 提取出来的伪随机密钥，扩展出指定长度的密钥（同时保证随机性）。以 HKDF-Extract 生成的 pre-master key 和下列信息作为输入，以生成 forward-secret key：</p>
<ul>
<li>QUIC key expansion</li>
<li>连接的 GUID</li>
<li>client hello message</li>
<li>server config</li>
<li>DER 编码证书</li>
</ul>
<p>总结来看就是，client hello message 获取到 server config，并生成 dh key，以该 key 作为 HKDF-Extract 的输入，生成 pre-master key，再通过 HKDF-Expand 生成 forward-secret key，即真正用来加密业务数据的密钥。</p>
<h1 id="cetv-tag">CETV Tag</h1>
<p>与 TLS 明文传输客户端证书不同，QUIC 的 client hello 中包含一个 CETV 标志，用于标记客户端证书、通道ID以及其他 hello 消息中的非公开数据。CETV 通过 AEAD 方式加密保护，所用密钥的生成方式与 forward-secret key 的生成方式类似。由于 client hello 只有一次，所以 AEAD 加密时使用的 nonce 可以是 0。</p>
<h1 id="证书压缩">证书压缩</h1>
<p>TLS 的证书链是按照源文件大小直接传递的，在握手阶段占大头。 QUIC 为了简化交互，将证书压缩后传输，并不传递CA根证书，而是在交互中包含本地缓存证书的摘要值，以确认双方是否共享同一证书链。</p>
<h1 id="参考">参考</h1>
<p><a href="https://docs.google.com/document/d/1g5nIXAIkN_Y-7XJW5K45IblHd_L2f5LTaDUDwvZ5L6g/edit#heading=h.sx7u0bm1ucc0">QUIC Crypto</a></p>
<p><a href="https://www.upyun.com/tech/article/571/QUIC%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3%E4%B9%8BInitial%E5%8C%85%E7%9A%84%E5%A4%84%E7%90%86.html">QUIC协议详解之Initial包的处理</a></p>
<p><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-tls13-28#appendix-A">The Transport Layer Security (TLS) Protocol Version 1.3 draft-ietf-tls-tls13-28</a></p>
<p><a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-transport-27/#section-7">QUIC: A UDP-Based Multiplexed and Secure Transport draft-ietf-quic-transport-27</a></p>
<p><a href="https://cryptologie.net/article/446/quic-crypto-and-simple-state-machines/">QUIC Crypto and simple state machines</a></p>
<p><a href="https://tls13.xargs.org/">The Illustrated TLS 1.3 Connection</a></p>
    </div>
    <div class="read-more">
      <a href="/post/%E5%85%B3%E4%BA%8Equic-crypto/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/2021/">2021</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2021-12-28 </span>
      <div class="post-category">
          <a href="/categories/log/"> log </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      结婚 首先要说的是，和女友恋爱668天后，于10月31日领证结婚了。 曾经一度认为自己在30岁前不会考虑结婚的事情，但是遇到一个知书达理善解人意
    </div>
    <div class="read-more">
      <a href="/post/2021/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/how_to_learn_new_programming_languages_and_frameworks_quickly/">How to learn new programming languages and frameworks quickly</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2021-12-21 </span>
      <div class="post-category">
          <a href="/categories/read/"> read </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <blockquote>
<p>An excerpt from <a href="https://www.quastor.org/p/how-whatsapp-scaled-to-1-billion">how-whatsapp-scaled-to-1-billion</a></p>
</blockquote>
<p><a href="https://news.ycombinator.com/item?id=28017289">This</a> is an interesting discussion on Hacker News for a process to learn new things quickly.</p>
<p>Here are some of the top answers summarized.</p>
    </div>
    <div class="read-more">
      <a href="/post/how_to_learn_new_programming_languages_and_frameworks_quickly/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/%E5%85%B3%E4%BA%8E%E5%8A%A0%E5%AF%86%E5%92%8C%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9A%84%E7%BB%8F%E9%AA%8C%E6%95%99%E8%AE%AD%E5%92%8C%E8%AF%AF%E8%A7%A3/">关于加密和密码学的经验教训和误解</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2021-11-19 </span>
      <div class="post-category">
          <a href="/categories/crypto/"> crypto </a>
          </div>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      本文翻译自stackexchange 密码学是一个广泛复杂的主题，即使经验丰富的工程师在初步应用密码技术时也会犯错，而加密又是一个重要的行为，
    </div>
    <div class="read-more">
      <a href="/post/%E5%85%B3%E4%BA%8E%E5%8A%A0%E5%AF%86%E5%92%8C%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9A%84%E7%BB%8F%E9%AA%8C%E6%95%99%E8%AE%AD%E5%92%8C%E8%AF%AF%E8%A7%A3/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    </section>
  
  <nav class="pagination">
    
    <a class="next" href="/page/2/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
  </nav>
        </div>
        

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:urchinzhou@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://twitter.com/AriesBlabla" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://github.com/Aries-0331" class="iconfont icon-github" title="github"></a>
  <a href="https://urchinzhou.com/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
     - 
    2024<span class="heart"><i class="iconfont icon-heart"></i></span><span>Aries</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXXX-X"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-XXXXXXXXX-X');
</script>








</body>
</html>
